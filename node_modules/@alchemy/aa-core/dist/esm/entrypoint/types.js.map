{"version":3,"file":"types.js","sourceRoot":"","sources":["../../../src/entrypoint/types.ts"],"names":[],"mappings":"","sourcesContent":["import type {\n  Abi,\n  Account,\n  Address,\n  Chain,\n  GetContractParameters,\n  Hash,\n  Hex,\n  Transport,\n} from \"viem\";\nimport type { EntryPointAbi_v6 } from \"../abis/EntryPointAbi_v6\";\nimport type { EntryPointAbi_v7 } from \"../abis/EntryPointAbi_v7\";\nimport type { UserOperationRequest } from \"../types\";\nimport type { EQ, IsOneOf, OneOf } from \"../utils\";\n\nexport interface EntryPointRegistryBase<T> {\n  \"0.6.0\": T;\n  \"0.7.0\": T;\n}\nexport type EntryPointVersion = keyof EntryPointRegistryBase<unknown>;\nexport type DefaultEntryPointVersion = OneOf<\"0.6.0\", EntryPointVersion>;\n\nexport type SupportedEntryPoint<\n  TEntryPointVersion extends EntryPointVersion = EntryPointVersion,\n  TChain extends Chain = Chain,\n  TAbi extends Abi | readonly unknown[] = Abi\n> = {\n  version: TEntryPointVersion;\n  address: Record<TChain[\"id\"] | \"default\", Address>;\n  abi: GetContractParameters<Transport, TChain, Account, TAbi>[\"abi\"];\n\n  /**\n   * Generates a hash for a UserOperation valid from entry point version 0.6 onwards\n   *\n   * @param request - the UserOperation to get the hash for\n   * @param entryPointAddress - the entry point address that will be used to execute the UserOperation\n   * @param chainId - the chain on which this UserOperation will be executed\n   * @returns the hash of the UserOperation\n   */\n  getUserOperationHash: (\n    request: UserOperationRequest<TEntryPointVersion>,\n    entryPointAddress: Address,\n    chainId: number\n  ) => Hash;\n\n  /**\n   * Pack the user operation data into bytes for hashing for entry point version 0.6 onwards\n   * Reference:\n   * v6: https://github.com/eth-infinitism/account-abstraction/blob/releases/v0.6/test/UserOp.ts#L16-L61\n   * v7: https://github.com/eth-infinitism/account-abstraction/blob/releases/v0.7/test/UserOp.ts#L28-L67\n   *\n   * @param request - the UserOperation to get the hash for\n   * @returns the hash of the UserOperation\n   */\n  packUserOperation: (\n    userOperation: UserOperationRequest<TEntryPointVersion>\n  ) => Hex;\n};\n\nexport interface EntryPointRegistry<TChain extends Chain = Chain>\n  extends EntryPointRegistryBase<\n    SupportedEntryPoint<EntryPointVersion, TChain, Abi>\n  > {\n  \"0.6.0\": SupportedEntryPoint<\"0.6.0\", TChain, typeof EntryPointAbi_v6>;\n  \"0.7.0\": SupportedEntryPoint<\"0.7.0\", TChain, typeof EntryPointAbi_v7>;\n}\n\n// [!region EntryPointDef]\nexport type EntryPointDef<\n  TEntryPointVersion extends EntryPointVersion = EntryPointVersion,\n  TChain extends Chain = Chain,\n  TAbi extends Abi | readonly unknown[] = Abi\n> = {\n  version: TEntryPointVersion;\n  address: Address;\n  chain: TChain;\n  abi: GetContractParameters<Transport, TChain, Account, TAbi>[\"abi\"];\n  getUserOperationHash: (\n    request: UserOperationRequest<TEntryPointVersion>\n  ) => Hex;\n  packUserOperation: (\n    userOperation: UserOperationRequest<TEntryPointVersion>\n  ) => Hex;\n};\n// [!endregion EntryPointDef]\n\nexport interface EntryPointDefRegistry<TChain extends Chain = Chain>\n  extends EntryPointRegistryBase<\n    EntryPointDef<EntryPointVersion, TChain, Abi>\n  > {\n  \"0.6.0\": EntryPointDef<\"0.6.0\", TChain, typeof EntryPointAbi_v6>;\n  \"0.7.0\": EntryPointDef<\"0.7.0\", TChain, typeof EntryPointAbi_v7>;\n}\n\nexport type GetEntryPointOptions<\n  TEntryPointVersion extends EntryPointVersion = DefaultEntryPointVersion\n> = EQ<TEntryPointVersion, DefaultEntryPointVersion> extends true\n  ?\n      | {\n          addressOverride?: Address;\n          version?: OneOf<TEntryPointVersion, EntryPointVersion>;\n        }\n      | undefined\n  : {\n      addressOverride?: Address;\n      version: OneOf<TEntryPointVersion, EntryPointVersion>;\n    };\n\nexport type EntryPointParameter<\n  TEntryPointVersion extends EntryPointVersion,\n  TChain extends Chain = Chain\n> = EQ<TEntryPointVersion, DefaultEntryPointVersion> extends true\n  ? {\n      entryPoint?: EntryPointDef<TEntryPointVersion, TChain>;\n    }\n  : {\n      entryPoint: IsOneOf<TEntryPointVersion, EntryPointVersion> extends true\n        ? EntryPointDef<TEntryPointVersion, TChain>\n        : never;\n    };\n"]}