{
  "version": 3,
  "sources": ["../../@biconomy/bundler/dist/esm/index.js", "../../@biconomy/bundler/dist/esm/Bundler.js", "../../@biconomy/bundler/dist/esm/utils/HelperFunction.js", "../../@biconomy/bundler/dist/esm/utils/Constants.js", "../../@biconomy/bundler/dist/esm/utils/Utils.js", "../../@biconomy/bundler/dist/esm/interfaces/IBundler.js", "../../@biconomy/bundler/dist/esm/utils/Types.js"],
  "sourcesContent": ["\"use strict\";import{Bundler as r}from\"./Bundler.js\";export*from\"./interfaces/IBundler.js\";export*from\"./Bundler.js\";export*from\"./utils/Types.js\";export*from\"./utils/Utils.js\";export const createBundler=r.create;\n", "\"use strict\";import{getChain as O}from\"@alchemy/aa-core\";import{createPublicClient as f,http as x}from\"viem\";import{transformUserOP as y,getTimestampInSeconds as l}from\"./utils/HelperFunction.js\";import{UserOpReceiptIntervals as w,UserOpWaitForTxHashIntervals as P,UserOpWaitForTxHashMaxDurationIntervals as R,UserOpReceiptMaxDurationIntervals as B,DEFAULT_ENTRYPOINT_ADDRESS as H}from\"./utils/Constants.js\";import{extractChainIdFromBundlerUrl as T}from\"./utils/Utils.js\";import{sendRequest as u,HttpMethod as p}from\"@biconomy/common\";export class Bundler{constructor(e){Object.defineProperty(this,\"bundlerConfig\",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,\"UserOpReceiptIntervals\",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,\"UserOpWaitForTxHashIntervals\",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,\"UserOpReceiptMaxDurationIntervals\",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,\"UserOpWaitForTxHashMaxDurationIntervals\",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,\"provider\",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const t=e?.chainId||T(e.bundlerUrl);this.bundlerConfig={...e,chainId:t},this.provider=f({chain:e.viemChain??O(t),transport:x((e.viemChain||O(t)).rpcUrls.default.http[0])}),this.UserOpReceiptIntervals={...w,...e.userOpReceiptIntervals},this.UserOpWaitForTxHashIntervals={...P,...e.userOpWaitForTxHashIntervals},this.UserOpReceiptMaxDurationIntervals={...B,...e.userOpReceiptMaxDurationIntervals},this.UserOpWaitForTxHashMaxDurationIntervals={...R,...e.userOpWaitForTxHashMaxDurationIntervals},this.bundlerConfig.entryPointAddress=e.entryPointAddress||H}getBundlerUrl(){return`${this.bundlerConfig.bundlerUrl}`}async estimateUserOpGas(e,t){e=y(e);const s=this.getBundlerUrl(),i=(await u({url:s,method:p.Post,body:{method:\"eth_estimateUserOperationGas\",params:t?[e,this.bundlerConfig.entryPointAddress,t]:[e,this.bundlerConfig.entryPointAddress],id:l(),jsonrpc:\"2.0\"}},\"Bundler\")).result;for(const a in i)if(!(a===\"maxFeePerGas\"||a===\"maxPriorityFeePerGas\")&&(i[a]===void 0||i[a]===null))throw new Error(`Got undefined ${a} from bundler`);return i}async sendUserOp(e,t){const s=this.bundlerConfig.chainId;e=y(e);const c={simulation_type:t||\"validation\"},i=[e,this.bundlerConfig.entryPointAddress,c],a=this.getBundlerUrl(),d=await u({url:a,method:p.Post,body:{method:\"eth_sendUserOperation\",params:i,id:l(),jsonrpc:\"2.0\"}},\"Bundler\");return{userOpHash:d.result,wait:h=>{const m=this.UserOpReceiptMaxDurationIntervals[s]||3e4;let v=0;return new Promise((U,b)=>{const o=this.UserOpReceiptIntervals[s]||5e3,r=setInterval(async()=>{try{const n=await this.getUserOpReceipt(d.result);if(n&&n.receipt&&n.receipt.blockNumber)if(h){const I=await this.provider.getBlockNumber(),g=Number(I)-n.receipt.blockNumber;if(h>=g){clearInterval(r),U(n);return}}else{clearInterval(r),U(n);return}}catch(n){clearInterval(r),b(n);return}v+=o,v>=m&&(clearInterval(r),b(new Error(`Exceeded maximum duration (${m/1e3} sec) waiting to get receipt for userOpHash ${d.result}. Try getting the receipt manually using eth_getUserOperationReceipt rpc method on bundler`)))},o)})},waitForTxHash:()=>{const h=this.UserOpWaitForTxHashMaxDurationIntervals[s]||2e4;let m=0;return new Promise((v,U)=>{const b=this.UserOpWaitForTxHashIntervals[s]||500,o=setInterval(async()=>{try{const r=await this.getUserOpStatus(d.result);if(r&&r.state&&r.transactionHash){clearInterval(o),v(r);return}}catch(r){clearInterval(o),U(r);return}m+=b,m>=h&&(clearInterval(o),U(new Error(`Exceeded maximum duration (${h/1e3} sec) waiting to get receipt for userOpHash ${d.result}. Try getting the receipt manually using eth_getUserOperationReceipt rpc method on bundler`)))},b)})}}}async getUserOpReceipt(e){const t=this.getBundlerUrl();return(await u({url:t,method:p.Post,body:{method:\"eth_getUserOperationReceipt\",params:[e],id:l(),jsonrpc:\"2.0\"}},\"Bundler\")).result}async getUserOpStatus(e){const t=this.getBundlerUrl();return(await u({url:t,method:p.Post,body:{method:\"biconomy_getUserOperationStatus\",params:[e],id:l(),jsonrpc:\"2.0\"}},\"Bundler\")).result}async getUserOpByHash(e){const t=this.getBundlerUrl();return(await u({url:t,method:p.Post,body:{method:\"eth_getUserOperationByHash\",params:[e],id:l(),jsonrpc:\"2.0\"}},\"Bundler\")).result}async getGasFeeValues(){const e=this.getBundlerUrl();return(await u({url:e,method:p.Post,body:{method:\"biconomy_getGasFeeValues\",params:[],id:l(),jsonrpc:\"2.0\"}},\"Bundler\")).result}static async create(e){return new Bundler(e)}}\n", "\"use strict\";export const transformUserOP=e=>{try{const r={...e},o=[\"nonce\",\"callGasLimit\",\"verificationGasLimit\",\"preVerificationGas\",\"maxFeePerGas\",\"maxPriorityFeePerGas\"];for(const t of o)r[t]&&r[t]!==\"0x\"&&(r[t]=\"0x\"+BigInt(e[t]).toString(16));return r}catch(r){throw`Failed to transform user operation: ${r}`}},getTimestampInSeconds=()=>Math.floor(Date.now()/1e3);\n", "\"use strict\";export const UserOpReceiptIntervals={1:1e4},UserOpWaitForTxHashIntervals={1:1e3},UserOpReceiptMaxDurationIntervals={1:3e5,80001:5e4,137:6e4,56:5e4,97:5e4,421613:5e4,42161:5e4,59140:5e4},UserOpWaitForTxHashMaxDurationIntervals={1:2e4},DEFAULT_ENTRYPOINT_ADDRESS=\"0x5ff137d4b0fdcd49dca30c7cf57e578a026d2789\";\n", "\"use strict\";export const extractChainIdFromBundlerUrl=e=>{try{const r=/\\/api\\/v2\\/(\\d+)\\/[a-zA-Z0-9.-]+$/.exec(e);return parseInt(r[1])}catch{throw new Error(\"Invalid chain id\")}},extractChainIdFromPaymasterUrl=e=>{try{const r=/\\/api\\/v\\d+\\/(\\d+)\\//.exec(e);if(!r)throw new Error(\"Invalid URL format\");return parseInt(r[1])}catch{throw new Error(\"Invalid chain id\")}};\n", "\"use strict\";export{};\n", "\"use strict\";export{};\n"],
  "mappings": "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",
  "names": []
}
